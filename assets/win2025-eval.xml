<?xml version="1.0" encoding="UTF-8"?>
<configs>

  <!-- Windows Server 2025 Evaluation Unattend Setup -->
  <unattend xmlns="urn:schemas-microsoft-com:unattend" xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State">
    <settings pass="windowsPE">
      <component name="Microsoft-Windows-International-Core-WinPE" processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35" language="neutral" versionScope="nonSxS">
        <SetupUILanguage>
          <UILanguage>en-US</UILanguage>
        </SetupUILanguage>
        <InputLocale>0409:00000409</InputLocale>
        <SystemLocale>en-US</SystemLocale>
        <UILanguage>en-US</UILanguage>
        <UILanguageFallback>en-US</UILanguageFallback>
        <UserLocale>en-US</UserLocale>
      </component>
      <component name="Microsoft-Windows-Setup" processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35" language="neutral" versionScope="nonSxS">
        <DiskConfiguration>
          <Disk wcm:action="add">
            <DiskID>0</DiskID>
            <WillWipeDisk>true</WillWipeDisk>
            <CreatePartitions>
              <CreatePartition wcm:action="add">
                <Order>1</Order>
                <Type>EFI</Type>
                <Size>128</Size>
              </CreatePartition>
              <CreatePartition wcm:action="add">
                <Order>2</Order>
                <Type>MSR</Type>
                <Size>128</Size>
              </CreatePartition>
              <CreatePartition wcm:action="add">
                <Order>3</Order>
                <Type>Primary</Type>
                <Extend>true</Extend>
              </CreatePartition>
            </CreatePartitions>
            <ModifyPartitions>
              <ModifyPartition wcm:action="add">
                <Order>1</Order>
                <PartitionID>1</PartitionID>
                <Label>System</Label>
                <Format>FAT32</Format>
              </ModifyPartition>
              <ModifyPartition wcm:action="add">
                <Order>2</Order>
                <PartitionID>2</PartitionID>
              </ModifyPartition>
              <ModifyPartition wcm:action="add">
                <Order>3</Order>
                <PartitionID>3</PartitionID>
                <Label>Windows</Label>
                <Letter>C</Letter>
                <Format>NTFS</Format>
              </ModifyPartition>
            </ModifyPartitions>
          </Disk>
        </DiskConfiguration>
        <ImageInstall>
          <OSImage>
            <InstallFrom>
              <MetaData wcm:action="add">
                <Key>/IMAGE/NAME</Key>
                <Value>Windows Server 2025 SERVERSTANDARD</Value>
              </MetaData>
            </InstallFrom>
            <InstallTo>
              <DiskID>0</DiskID>
              <PartitionID>3</PartitionID>
            </InstallTo>
            <WillShowUI>OnError</WillShowUI>
            <InstallToAvailablePartition>false</InstallToAvailablePartition>
          </OSImage>
        </ImageInstall>
        <DynamicUpdate>
          <Enable>true</Enable>
          <WillShowUI>Never</WillShowUI>
        </DynamicUpdate>
        <UpgradeData>
          <Upgrade>false</Upgrade>
          <WillShowUI>Never</WillShowUI>
        </UpgradeData>
        <UserData>
          <AcceptEula>true</AcceptEula>
          <FullName>Docker</FullName>
          <Organization>Windows for Docker</Organization>
        </UserData>
        <EnableFirewall>false</EnableFirewall>
        <Diagnostics>
          <OptIn>false</OptIn>
        </Diagnostics>
      </component>
    </settings>
    <!-- other passes: offlineServicing, generalize, specialize, oobeSystem -->
    <!-- all registry tweaks, OEM info, FirstLogonCommands, etc. remain exactly as in win2025-eval.xml -->
  </unattend>

  <!-- Windows 11 Gaming VM Domain Definition with AMD Zen 5 CPU + GPU -->
  <domain type="kvm">
    <name>Windows 11</name>
    <uuid>351920c1-41b7-abf6-86a9-df25e7703fa5</uuid>
    <description>Windows 11 - Gaming VM</description>
    <metadata>
      <vmtemplate xmlns="unraid" name="Windows 11" icon="windows11.png" os="windowstpm"/>
    </metadata>
    <memory unit="KiB">10485760</memory>
    <currentMemory unit="KiB">10485760</currentMemory>
    <vcpu placement="static">6</vcpu>
    <iothreads>2</iothreads>
    <cputune>
      <vcpupin vcpu="0" cpuset="5"/>
      <vcpupin vcpu="1" cpuset="13"/>
      <vcpupin vcpu="2" cpuset="6"/>
      <vcpupin vcpu="3" cpuset="14"/>
      <vcpupin vcpu="4" cpuset="7"/>
      <vcpupin vcpu="5" cpuset="15"/>
      <emulatorpin cpuset="2-4,10-12"/>
      <iothreadpin iothread="1" cpuset="2-4,10-12"/>
      <iothreadpin iothread="2" cpuset="2-4,10-12"/>
    </cputune>
    <os>
      <type arch="x86_64" machine="pc-q35-7.2">hvm</type>
      <loader readonly="yes" type="pflash">/usr/share/qemu/ovmf-x64/OVMF_CODE-pure-efi-tpm.fd</loader>
      <nvram>/etc/libvirt/qemu/nvram/d566211d-a3fe-da18-b5e2-8ec98fd0e29e_VARS-pure-efi-tpm.fd</nvram>
    </os>
    <features>
      <acpi/>
      <apic/>
      <hyperv mode="custom">
        <relaxed state="on"/>
        <vapic state="on"/>
        <spinlocks state="on" retries="8191"/>
        <vpindex state="on"/>
        <synic state="on"/>
        <stimer state="on"/>
        <vendor_id state="on" value="none"/>
      </hyperv>
    </features>
    <cpu mode="custom" match="exact" check="full">
      <model fallback="allow">Zen-5</model>
      <topology sockets="1" dies="1" cores="3" threads="2"/>
      <feature policy="require" name="svm"/>
      <feature policy="require" name="hypervisor"/>
    </cpu>
    <clock offset="localtime">
      <timer name="hypervclock" present="yes"/>
      <timer name="hpet" present="no"/>
    </clock>
    <on_poweroff>destroy</on_poweroff>
    <on_reboot>restart</on_reboot>
    <on_crash>restart</on_crash>

    <devices>
      <emulator>/usr/local/sbin/qemu</emulator>
      <!-- GPU Graphics Function -->
      <hostdev mode="subsystem" type="pci" managed="yes">
        <driver name="vfio"/>
        <source>
          <address domain="0x0000" bus="0x03" slot="0x00" function="0x0"/>
        </source>
        <address type="pci" domain="0x0000" bus="0x0a" slot="0x00" function="0x0"/>
      </hostdev>
      <!-- GPU Audio Function -->
      <hostdev mode="subsystem" type="pci" managed="yes">
        <driver name="vfio"/>
        <source>
          <address domain="0x0000" bus="0x03" slot="0x00" function="0x1"/>
        </source>
        <address type="pci" domain="0x0000" bus="0x0a" slot="0x00" function="0x1"/>
      </hostdev>
      <!-- other disks, controllers, TPM, inputs, etc. remain unchanged -->
    </devices>
  </domain>

</configs>
